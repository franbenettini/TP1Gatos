<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8"/>
  <title>JSON: Task 1</title>
  <link rel="stylesheet" href="/style.css" />
</head>

<body>
  <h1>Cat Information</h1>
  <section class="preview"></section>

  <script>
    const section = document.querySelector('section');

    let para1 = document.createElement('p');
    let para2 = document.createElement('p');
    let motherInfo = 'The mother cats are called ';
    let kittenInfo;
    const requestURL = 'https://mdn.github.io/learning-area/javascript/oojs/tasks/json/sample.json';

    fetch(requestURL)
      .then(response => response.text())
      .then(text => {
          console.log("Data fetched:", text); // Verificar si se obtienen los datos
          displayCatInfo(text);
      })
      .catch(error => console.error("Error fetching data:", error));

    function displayCatInfo(catString) {
        console.log("Processing data...");

        let total = 0;
        let male = 0;
        let female = 0;

        const cats = JSON.parse(catString);

        // Recorrer las madres gatas
        cats.forEach((cat, index) => {
            motherInfo += cat.name;
            if (index < cats.length - 2) {
                motherInfo += ', ';
            } else if (index === cats.length - 2) {
                motherInfo += ' y ';
            } else {
                motherInfo += '.';
            }

            // Recorrer los gatitos
            cat.kittens.forEach(kitten => {
                total++;
                if (kitten.gender === 'm') {
                    male++;
                } else if (kitten.gender === 'f') {
                    female++;
                }
            });
        });

        kittenInfo = `Total de gatitos: ${total}, Machos: ${male}, Hembras: ${female}`;

        para1.textContent = motherInfo;
        para2.textContent = kittenInfo;
    }

    section.appendChild(para1);
    section.appendChild(para2);
  </script>
</body>
</html>
